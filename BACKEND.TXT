âš¡ï¸ PROMPT COMPLETO: â€œBACKEND â€” Control de Inventario de Tienda de Videojuegosâ€

âš™ï¸ Objetivo:
Crear el backend completo para una aplicaciÃ³n de control de inventario de videojuegos y consolas, cumpliendo todas las especificaciones tÃ©cnicas exigidas en el taller.

ğŸ§± 1. Estructura general del proyecto

Genera un backend en Node.js + Express con conexiÃ³n a MongoDB, que tenga la siguiente estructura de carpetas:

ğŸ“ backend/
â”‚
â”œâ”€â”€ ğŸ“ config/
â”‚   â””â”€â”€ db.js                   # ConexiÃ³n a MongoDB con mongoose
â”‚
â”œâ”€â”€ ğŸ“ models/
â”‚   â””â”€â”€ Producto.js             # Esquema del producto
â”‚   â””â”€â”€ Venta.js                # Esquema de la venta
â”‚
â”œâ”€â”€ ğŸ“ controllers/
â”‚   â””â”€â”€ productoController.js   # Controlador CRUD de productos
â”‚   â””â”€â”€ ventaController.js      # Controlador de ventas (incluye validaciÃ³n de stock)
â”‚
â”œâ”€â”€ ğŸ“ routes/
â”‚   â””â”€â”€ productoRoutes.js
â”‚   â””â”€â”€ ventaRoutes.js
â”‚
â”œâ”€â”€ ğŸ“ middlewares/
â”‚   â””â”€â”€ errorHandler.js         # Manejo centralizado de errores
â”‚
â”œâ”€â”€ .env                        # Variables de entorno
â”œâ”€â”€ server.js                   # Punto de entrada principal
â”œâ”€â”€ package.json
â””â”€â”€ README.md                   # DocumentaciÃ³n del backend

ğŸš€ 2. Requisitos tÃ©cnicos obligatorios

Framework: Node.js con Express.

Base de datos: MongoDB usando mongoose.

Variables de entorno: mediante dotenv (para URL de la base y puerto).

Validaciones: usando express-validator.

CORS: configurado para permitir conexiÃ³n con el frontend.

Manejo de errores: con middlewares personalizados.

Estructura modular: rutas, controladores, modelos y configuraciÃ³n separados.

Respuestas HTTP adecuadas: cÃ³digos 200, 400, 404, 500 segÃºn el caso.

Mensajes claros: en formato JSON.

ğŸ® 3. Reglas funcionales del sistema
ğŸ”¸ MÃ³dulo Productos

Cada producto debe tener los campos:

nombre (string, requerido)

tipo (string, valores posibles: â€œjuegoâ€ o â€œconsolaâ€)

precio (number, mayor que 0)

cantidad (number, entero mayor o igual a 0)

Endpoints requeridos:

GET /api/productos â†’ listar todos

GET /api/productos/:id â†’ obtener uno

POST /api/productos â†’ registrar nuevo (validar campos)

PUT /api/productos/:id â†’ editar datos

DELETE /api/productos/:id â†’ eliminar producto

ğŸ”¸ MÃ³dulo Ventas

Cada venta debe guardar:

producto (referencia al producto vendido)

cantidadVendida

fecha (automÃ¡tica)

Al registrar una venta (POST /api/ventas):

Validar que el producto exista.

Validar que haya stock suficiente.

Si hay stock â†’ descontar automÃ¡ticamente.

Si no hay â†’ devolver error 400 con mensaje "Stock insuficiente".

ğŸ§© 4. Dependencias necesarias

Instala las siguientes dependencias:

npm install express mongoose cors dotenv express-validator


Dependencias opcionales para desarrollo:

npm install nodemon --save-dev

ğŸ§° 5. Archivo .env obligatorio

Debe incluir:

PORT=3000
MONGO_URI=mongodb+srv://<usuario>:<password>@<cluster>/<nombreDB>

ğŸ§© 6. ConfiguraciÃ³n de CORS

En server.js, debes incluir:

import cors from "cors";
app.use(cors({
  origin: "http://localhost:5500", // frontend autorizado
  methods: ["GET", "POST", "PUT", "DELETE"]
}));

âš™ï¸ 7. Validaciones con express-validator

Ejemplo para productos:

import { check } from "express-validator";

const validarProducto = [
  check("nombre").notEmpty().withMessage("El nombre es obligatorio"),
  check("tipo").isIn(["juego", "consola"]).withMessage("El tipo debe ser 'juego' o 'consola'"),
  check("precio").isFloat({ gt: 0 }).withMessage("El precio debe ser mayor que 0"),
  check("cantidad").isInt({ min: 0 }).withMessage("La cantidad debe ser un nÃºmero entero positivo"),
];

ğŸ§¾ 8. Respuestas esperadas (JSON)

Ejemplo de respuesta correcta:

{
  "message": "Producto creado correctamente",
  "producto": {
    "_id": "67890...",
    "nombre": "PS5",
    "tipo": "consola",
    "precio": 3200000,
    "cantidad": 10
  }
}


Ejemplo de error:

{
  "error": "Stock insuficiente"
}

ğŸ§  9. Middleware de errores

Debe capturar cualquier error y responder con cÃ³digo y mensaje:

export const errorHandler = (err, req, res, next) => {
  console.error(err.stack);
  res.status(500).json({ error: "Error interno del servidor" });
};

ğŸ“˜ 10. DocumentaciÃ³n en README.md

Debe incluir:

DescripciÃ³n del proyecto.

Requisitos previos.

Pasos de instalaciÃ³n.

Ejemplo del archivo .env.

Lista de endpoints con ejemplos de uso.

CÃ³mo iniciar el servidor (npm start o nodemon server.js).

ğŸ’¡ 11. Condiciones adicionales

El cÃ³digo debe estar comentado para explicar las partes principales.

El proyecto debe poder probarse fÃ¡cilmente con Postman.

Al iniciarse el servidor, debe mostrar un mensaje en consola confirmando la conexiÃ³n a MongoDB.

Se debe manejar la conexiÃ³n y reconexiÃ³n a la base de datos con manejo de errores.

ğŸ§© Prompt Final

ğŸ§  PROMPT FINAL (cÃ³pialo asÃ­):

Crea el backend completo para el proyecto Control de Inventario de Tienda de Videojuegos usando Node.js, Express y MongoDB, cumpliendo los siguientes puntos:

Usa estructura modular profesional con carpetas /config, /models, /controllers, /routes, /middlewares.

Implementa CORS, dotenv, express-validator, y mongoose correctamente.

Incluye validaciones, manejo de errores, y mensajes JSON claros.

Los mÃ³dulos son: Productos y Ventas, con validaciones de stock, CRUD completo y persistencia en MongoDB.

Usa respuestas HTTP adecuadas, comentarios explicativos, y conexiÃ³n robusta a MongoDB.

Genera un README.md documentado explicando instalaciÃ³n, configuraciÃ³n, endpoints y pruebas con Postman.

âœ… Cumple con todas las reglas del taller original:

Uso de variables de entorno.

ModularizaciÃ³n.

Validaciones.

CORS.

Buenas prÃ¡cticas.

Persistencia de datos.

CÃ³digo limpio y documentado.